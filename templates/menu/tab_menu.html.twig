{% extends '@KnpMenu/menu.html.twig' %}
{% set debug = options['debug']|default(false) %}
{% block root %}
    <!-- {{ _self }} -->
    {% set listAttributes = item.childrenAttributes %}
    {{ block('list') -}}
{% endblock %}

{% block item %}
{#    {{ dump(item) }}#}
    {% set icon = item.attributes.icon|default('fa-question-mark') %}
    {% set badge = item.extras.badge|default(false) %}
<ons-tab page="{{ item.name }}" label="{{ item.label }}"
        {{ stimulus_target('app','tab') }}
         {% if icon %}icon="{{ icon }}"{% endif %}
         {% if badge %}badge="{{ badge.value }}"{% endif %}
{#        {% if item.name=='saved' ? 'active' %}{% endif %}#}
        {# active-icon #}
>
</ons-tab>
{% endblock %}

{% block list %}
    {# we could add the ons-page or ons-tab wrapper here #}
    {% if item.hasChildren and options.depth is not same as(0) and item.displayChildren %}
        {% import _self as knp_menu %}
        {{ block('children') }}
    {% endif %}
{% endblock %}

{#{% block children %}#}
{#    #}{# save current variables #}
{#    {% set currentOptions = options %}#}
{#    {% set currentItem = item %}#}
{#    #}{# update the depth for children #}
{#    {% if options.depth is not none %}#}
{#        {% set options = options|merge({'depth': currentOptions.depth - 1}) %}#}
{#    {% endif %}#}
{#    #}{# update the matchingDepth for children #}
{#    {% if options.matchingDepth is not none and options.matchingDepth > 0 %}#}
{#        {% set options = options|merge({'matchingDepth': currentOptions.matchingDepth - 1}) %}#}
{#    {% endif %}#}
{#    {% for item in currentItem.children %}#}
{#        {{ block('item') }}#}
{#    {% endfor %}#}
{#    #}{# restore current variables #}
{#    {% set item = currentItem %}#}
{#    {% set options = currentOptions %}#}
{#{% endblock %}#}

{#{% block linkElement %}{% import _self as knp_menu %}<a href="{{ item.uri }}"{{ knp_menu.attributes(item.linkAttributes) }}>{{ block('label') }}</a>{% endblock %}#}

{#{% block spanElement %}{% import _self as knp_menu %}<span{{ knp_menu.attributes(item.labelAttributes) }}>{{ block('label') }}</span>{% endblock %}#}

{#{% block label %}{% if options.allow_safe_labels and item.getExtra('safe_label', false) %}{{ item.label|raw }}{% else %}{{ item.label }}{% endif %}{% endblock %}#}
